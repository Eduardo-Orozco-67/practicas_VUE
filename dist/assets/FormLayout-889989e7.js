import{_ as v,r as n,o as b,c as y,a as s,b as e,w as l,e as x,f as U,d as p,t as f}from"./index-6c456330.js";const V={data(){return{tablaCompras:[{cns:1,nomProducto:"Impresora LaserJet Color",cantidad:2,precioUnitario:5200,precioParcial:10400},{cns:2,nomProducto:"Monitor LED 31 plg.",cantidad:3,precioUnitario:1700,precioParcial:5100}],productoItem:{cns:null,nomProducto:null,cantidad:null,precioUnitario:null,precioParcial:null},totalCompra:0,eliminarDialogVisible:!1,editando:!1,nuevoRegistro:!0}},computed:{subtotal(){return this.tablaCompras.reduce((o,t)=>o+(t.precioParcial||0),0)},iva(){return this.subtotal*.16},total(){return this.subtotal+this.iva}},watch:{"productoItem.cantidad":"actualizarSubtotalIvaTotal","productoItem.precioUnitario":"actualizarSubtotalIvaTotal"},methods:{formatoMoneda(o){return o?o.toLocaleString("en-US",{style:"currency",currency:"USD"}):""},registrarCompra(){this.productoItem.nomProducto&&this.productoItem.cantidad&&this.productoItem.precioUnitario&&(this.productoItem.cns=this.tablaCompras.length+1,this.productoItem.precioParcial=this.productoItem.cantidad*this.productoItem.precioUnitario,this.tablaCompras.push({...this.productoItem}),this.limpiarCamposEntrada(),this.$refs.toast.add({severity:"success",summary:"Confirmación",detail:"Nueva compra registrada",life:3e3}))},editarProductos(o){this.editando=!0,this.productoItem.cns=o.cns,this.productoItem.nomProducto=o.nomProducto,this.productoItem.cantidad=o.cantidad,this.productoItem.precioUnitario=o.precioUnitario,this.productoItem.precioParcial=o.precioParcial,this.nuevoRegistro=!1},confirmarEliminacion(o){this.productoItem={...o},this.eliminarDialogVisible=!0},eliminarProducto(o){const t=this.tablaCompras.findIndex(m=>m.cns===o.cns);t!==-1&&(this.tablaCompras.splice(t,1),this.actualizarTotalCompra(),this.eliminarDialogVisible=!1,this.$refs.toast.add({severity:"success",summary:"Confirmación",detail:"Producto eliminado",life:3e3}))},guardarCambios(){const o=this.tablaCompras.findIndex(t=>t.cns===this.productoItem.cns);o!==-1&&(this.tablaCompras[o]={...this.productoItem},this.actualizarTotalCompra(),this.limpiarCamposEntrada(),this.editando=!1,this.$refs.toast.add({severity:"success",summary:"Confirmación",detail:"Cambios guardados",life:3e3}),this.editando=!1,this.nuevoRegistro=!0)},actualizarTotalCompra(){this.totalCompra=this.tablaCompras.reduce((o,t)=>o+(t.precioParcial||0),0)},limpiarCamposEntrada(){this.productoItem.cns=null,this.productoItem.nomProducto="",this.productoItem.cantidad=null,this.productoItem.precioUnitario=null,this.productoItem.precioParcial=null},actualizarSubtotalIvaTotal(){const o=parseFloat(this.productoItem.cantidad),t=parseFloat(this.productoItem.precioUnitario);!isNaN(o)&&!isNaN(t)?this.productoItem.precioParcial=o*t:this.productoItem.precioParcial=null}}},T={class:"p-grid"},k={class:"p-col-12"},D={class:"card"},N=s("br",null,null,-1),w=s("br",null,null,-1),E=s("label",{for:"subtotal"},"Subtotal: ",-1),L=s("label",{for:"iva"},"IVA (16%): ",-1),R=s("label",{for:"total"},"Total: ",-1),S=s("div",null," ¿Estás seguro de que deseas eliminar este producto? ",-1),z={class:"p-d-flex p-jc-end"};function M(o,t,m,B,i,r){const c=n("InputText"),d=n("Button"),h=n("Toolbar"),u=n("Column"),C=n("DataTable"),P=n("Panel"),I=n("Dialog"),g=n("Toast");return b(),y("div",T,[s("div",k,[s("div",D,[e(P,{header:"PUNTO DE VENTA (POS)",style:{height:"100%"}},{default:l(()=>[e(h,{class:"p-mb-4"},{start:l(()=>[e(c,{type:"text",size:"40",placeholder:"Nombre del producto...",modelValue:i.productoItem.nomProducto,"onUpdate:modelValue":t[0]||(t[0]=a=>i.productoItem.nomProducto=a)},null,8,["modelValue"]),e(c,{type:"text",placeholder:"Cant",modelValue:i.productoItem.cantidad,"onUpdate:modelValue":t[1]||(t[1]=a=>i.productoItem.cantidad=a)},null,8,["modelValue"]),e(c,{type:"text",placeholder:"$ Precio U.",modelValue:i.productoItem.precioUnitario,"onUpdate:modelValue":t[2]||(t[2]=a=>i.productoItem.precioUnitario=a)},null,8,["modelValue"])]),end:l(()=>[i.editando?(b(),x(d,{key:0,label:"Guardar Cambios",icon:"pi pi-check",class:"p-button-primary p-mr-2",onClick:r.guardarCambios},null,8,["onClick"])):U("",!0),e(d,{label:"Registrar",icon:"pi pi-plus",class:"p-button-success p-mr-2",onClick:r.registrarCompra,disabled:!i.nuevoRegistro},null,8,["onClick","disabled"])]),_:1}),N,e(C,{value:i.tablaCompras,selection:i.productoItem,"onUpdate:selection":t[3]||(t[3]=a=>i.productoItem=a),class:"p-datatable-gridlines",dataKey:"cns",rows:5,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Visualizando {last} de {totalRecords} productos",style:{"margin-bottom":"20px"},paginator:!0,responsiveLayout:"scroll"},{default:l(()=>[e(u,{field:"cns",header:"Cns",sortable:!0,style:{width:"50px"}}),e(u,{field:"nomProducto",header:"Nombre del Producto",style:{width:"370px"}}),e(u,{field:"precioUnitario",header:"Precio U.",dataType:"numeric",style:{width:"80px"}},{body:l(a=>[p(f(r.formatoMoneda(a.data.precioUnitario)),1)]),_:1}),e(u,{field:"cantidad",header:"Cant.",style:{width:"60px","text-align":"center"}}),e(u,{field:"precioParcial",header:"Precio P.",style:{width:"80px"}},{body:l(a=>[p(f(r.formatoMoneda(a.data.precioParcial)),1)]),_:1}),e(u,{style:{width:"140px"}},{header:l(()=>[p(" Acciones ")]),body:l(a=>[e(d,{icon:"pi pi-pencil",type:"button",class:"p-button-success p-mr-2 p-mb-1",onClick:_=>r.editarProductos(a.data)},null,8,["onClick"]),e(d,{icon:"pi pi-trash",type:"button",class:"p-button-danger p-mb-1",onClick:_=>r.confirmarEliminacion(a.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection"]),w,e(h,{class:"p-mb-4"},{start:l(()=>[]),end:l(()=>[E,e(c,{id:"subtotal",type:"text",placeholder:"$ ",value:r.formatoMoneda(r.subtotal),readonly:""},null,8,["value"]),L,e(c,{id:"iva",type:"text",placeholder:"$ ",value:r.formatoMoneda(r.iva),readonly:""},null,8,["value"]),R,e(c,{id:"total",type:"text",placeholder:"$ ",value:r.formatoMoneda(r.total),readonly:""},null,8,["value"])]),_:1})]),_:1}),e(I,{header:"Confirmar eliminación",visible:i.eliminarDialogVisible,onHide:t[6]||(t[6]=a=>i.eliminarDialogVisible=!1)},{default:l(()=>[S,s("div",z,[e(d,{label:"Cancelar",class:"p-button-text",onClick:t[4]||(t[4]=a=>i.eliminarDialogVisible=!1)}),e(d,{label:"Eliminar",class:"p-button-danger",onClick:t[5]||(t[5]=a=>r.eliminarProducto(i.productoItem))})])]),_:1},8,["visible"]),e(g,{ref:"toast"},null,512)])])])}const A=v(V,[["render",M]]);export{A as default};
